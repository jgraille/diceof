<!-- app/views/index.scala.html -->
@()
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dice Probability Versus</title>
  <link href='@("https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css")' rel='stylesheet'>
  <script src="https://kit.fontawesome.com/a2e0da0e76.js" crossorigin="anonymous"></script>
  <style>
    .dice-icon { font-size: 2em; color: #007bff; margin: 0.1em; }
    .dice-row { display: flex; flex-wrap: wrap; gap: 0.2em; }
    .card { border-radius: 16px; box-shadow: 0 0 20px rgba(0,0,0,0.1); }
  </style>
</head>
<body class="bg-light">

  <div class="container py-5">
    <h1 class="text-center mb-4">üé≤ Dice Probability Versus</h1>

    <div class="row g-4">
      <div class="col-md-6">
        <div class="card p-4">
          <h4>Roll A</h4>
          <label class="form-label">Number of Dice</label>
          <input type="number" id="nbDicesA" class="form-control mb-2" value="5" min="1">
          <label>Expected values
          <select id="expectedValueA" class="form-control">
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
              <option>6</option>
              <option>2+</option>
              <option>3+</option>
              <option>4+</option>
              <option selected>5+</option>
            </select>
          </label>
          <label class="form-label">Number of occurrences</label>
          <input type="number" id="occurrencesA" class="form-control mb-2" value="2" min="0">
          <div id="diceDisplayA" class="dice-row mt-2"></div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="card p-4">
          <h4>Roll B</h4>
          <label class="form-label">Number of Dice</label>
          <input type="number" id="nbDicesB" class="form-control mb-2" value="2" min="1">
          <label>Expected values
          <select id="expectedValueB" class="form-control">
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
              <option>6</option>
              <option>2+</option>
              <option>3+</option>
              <option>4+</option>
              <option>5+</option>
            </select>
          </label>
          <label class="form-label">Number of occurrences</label>
          <input type="number" id="occurrencesB" class="form-control mb-2" value="1" min="0">
          <div id="diceDisplayB" class="dice-row mt-2"></div>
        </div>
      </div>
    </div>

    <div class="text-center mt-4">
      <button id="compareBtn" class="btn btn-primary btn-lg">Compare Probabilities</button>
    </div>

    <div id="result" class="text-center mt-5"></div>
  </div>

  <script>
    function renderDice(containerId, count) {
      const container = document.getElementById(containerId);
      container.innerHTML = '';
      for (let i = 0; i < count; i++) {
        const dice = document.createElement("i");
        dice.className = "fas fa-dice dice-icon";
        container.appendChild(dice);
      }
    }

    function updateDiceDisplays() {
      renderDice("diceDisplayA", parseInt(document.getElementById("nbDicesA").value));
      renderDice("diceDisplayB", parseInt(document.getElementById("nbDicesB").value));
    }

    document.getElementById("compareBtn").addEventListener("click", () => {
      const payload = {
        nbDicesA: parseInt(document.getElementById("nbDicesA").value),
        expectedValueA: document.getElementById("expectedValueA").value,
        occurrencesA: parseInt(document.getElementById("occurrencesA").value),
        nbDicesB: parseInt(document.getElementById("nbDicesB").value),
        expectedValueB: document.getElementById("expectedValueB").value,
        occurrencesB: parseInt(document.getElementById("occurrencesB").value)
      };

      updateDiceDisplays();

      fetch("/roll", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      })
      .then(res => res.json())
      .then(data => {
        document.getElementById("result").innerHTML = `
          <div class="card p-4 mt-4">
            <h5>Results</h5>
            <p><strong>Roll A:</strong> ${ (data.probA * 100).toFixed(2) }% chance</p>
            <p><strong>Roll B:</strong> ${ (data.probB * 100).toFixed(2) }% chance</p>
            <h3 class="mt-3">üèÜ Winner: ${data.winner}</h3>
          </div>
        `;
      });
    });

    document.getElementById("nbDicesA").addEventListener("input", updateDiceDisplays);
    document.getElementById("nbDicesB").addEventListener("input", updateDiceDisplays);
    window.onload = updateDiceDisplays;
  </script>

</body>
</html>